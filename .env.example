################################################################################
# MANDATORY: Station Identity (CHANGE THESE)
################################################################################

# Station ID used for lock ownership and UI display
NEXT_PUBLIC_STATION_ID=CHANGE_ME_STATION_ID
# Server-side station identity (fallback when NEXT_PUBLIC_* unavailable)
STATION_ID=CHANGE_ME_STATION_ID

# Host identifiers used in Krosy payloads (e.g., <sourceHostname>, <targetHostName>)
NEXT_PUBLIC_KROSY_SOURCE_HOSTNAME=CHANGE_ME_HOSTNAME
NEXT_PUBLIC_KROSY_XML_TARGET=CHANGE_ME_HOSTNAME

################################################################################
# Mode (online/offline)
################################################################################

# true → online (use NEXT_PUBLIC_KROSY_URL_ONLINE)
# false → offline (use NEXT_PUBLIC_KROSY_URL_OFFLINE)
NEXT_PUBLIC_KROSY_ONLINE=true  # DO NOT CHANGE unless you need offline mode

################################################################################
# Krosy URLs & Connectivity
################################################################################

# Krosy endpoints used by Setup (pins/aliases extraction)
# Use relative paths; the app server proxies/handles these.
NEXT_PUBLIC_KROSY_URL_ONLINE=/api/krosy
NEXT_PUBLIC_KROSY_URL_OFFLINE=/api/krosy-offline

# Checkpoint endpoints (send workingDataXml or intksk)
NEXT_PUBLIC_KROSY_URL_CHECKPOINT_ONLINE=/api/krosy/checkpoint        # DO NOT CHANGE
NEXT_PUBLIC_KROSY_URL_CHECKPOINT_OFFLINE=/api/krosy-offline/checkpoint # DO NOT CHANGE

# Identity URL (GET) returning hostname/ip/mac for UI
NEXT_PUBLIC_KROSY_IDENTITY_URL=/api/krosy

# Network hints for online/offline decision (optional)
NEXT_PUBLIC_KROSY_IP_ONLINE=172.26.202.248
NEXT_PUBLIC_KROSY_IP_OFFLINE=192.168.1.164

# Offline forward target (proxy); used by /api/krosy-offline
NEXT_PUBLIC_KROSY_OFFLINE_TARGET_URL=http://localhost:3001/api/visualcontrol

# Client HTTP timeout for Krosy requests (ms)
NEXT_PUBLIC_KROSY_HTTP_TIMEOUT_MS=30000

# Server-side transport (TCP) for Krosy, if applicable
KROSY_TRANSPORT=tcp
KROSY_TCP_PORT=10080
KROSY_TCP_TIMEOUT_MS=10000
KROSY_TCP_TERMINATOR=newline
KROSY_CONNECT_HOST=172.26.192.1
KROSY_LOG_DIR=.krosy-logs

# Optional VisualControl page used for debugging
NEXT_PUBLIC_KROSY_VISUALCONTROL_URL=http://localhost:3001/visualcontrol

# Allowed web client origins (server CORS)
KROSY_CLIENT_ORIGINS=http://172.26.202.248:3000,http://localhost:3000,http://localhost:3001,http://192.168.1.164:3001

################################################################################
# Locks (Redis)
################################################################################

# Redis connection URL
REDIS_URL=redis://127.0.0.1:6379

# Server policy: require Redis for lock endpoints
KSK_REQUIRE_REDIS=1

# Server default TTL for KSK locks (seconds)
KSK_DEFAULT_TTL_SEC=172800

# Client heartbeat TTL used by Setup page (seconds)
NEXT_PUBLIC_KSK_TTL_SEC=172800

# Extra terminal logging for /api/ksk-lock GET (detail rows)
KSK_LOCK_LOG_DETAIL=1

################################################################################
# Check Behavior
################################################################################

# How /api/serial/check builds the pins to send:
# mac|union|client|merge
CHECK_SEND_MODE=merge

# Additional CHECK timeouts and retry settings (ms)
CHECK_RESULT_TIMEOUT_MS=9000
CHECK_HANDSHAKE_TIMEOUT_MS=400
NEXT_PUBLIC_CHECK_CLIENT_TIMEOUT_MS=5000
NEXT_PUBLIC_CHECK_RETRY_COUNT=1

################################################################################
# ESP / Serial & Scanners
################################################################################

# Explicit ESP TTY path (prefer /dev/ttyUSB*)
ESP_TTY=/dev/ttyUSB0
ESP_TTY_PATH=/dev/ttyUSB0

# Simulation mode (mock ESP + scanner)
# When enabled, the app does not require real ESP hardware. Serial interactions
# are simulated and typical lines like "Sent 'CHECK' to <MAC>", "RESULT SUCCESS <MAC>"
# are emitted so the UI and APIs behave as if connected.
# Accepts: 1/true/TRUE/yes
SIMULATE=0

# ESP health & PING
ESP_PING_CMD=PING {payload}

# Scanner device list (comma-separated)
SCANNER_TTY_PATHS=/dev/ttyACM0,/dev/ttyACM1
# Which indices each UI uses
NEXT_PUBLIC_SCANNER_INDEX_DASHBOARD=0
NEXT_PUBLIC_SCANNER_INDEX_SETUP=1
# Serial/scanner tuning
SCANNER_BAUD=9600
SCANNER_OPEN_TIMEOUT_MS=4000
SCANNER_ALLOW_RAW_MAC=1
SCANNER_PRINTABLE_ONLY=0
NET_IFACE=eth0

################################################################################
# UI Behavior & Patterns
################################################################################

# Hide settings page link in UI
NEXT_PUBLIC_HIDE_SETTINGS=true

# KFB (MAC) regex accepted by inputs
NEXT_PUBLIC_KFB_REGEX=/^([0-9A-F]{2}([:\-]?)){5}[0-9A-F]{2}$/i

# Setup page retry/timeout tuning
NEXT_PUBLIC_SETUP_HTTP_TIMEOUT_MS=8000
NEXT_PUBLIC_SETUP_EXTRACT_RETRIES=1
NEXT_PUBLIC_SETUP_EXTRACT_RETRY_MS=600

# Setup behavior flags
NEXT_PUBLIC_SETUP_ALLOW_NO_ESP=0
NEXT_PUBLIC_KEEP_LOCKS_ON_UNLOAD=0
NEXT_PUBLIC_KSK_REQUIRE_REDIS=1

# Aliases (client policy)
NEXT_PUBLIC_ALIAS_CLEAR_ON_READY=0
NEXT_PUBLIC_ALIAS_MIRROR_REDIS=0
NEXT_PUBLIC_ALIAS_REQUIRE_REDIS=0
NEXT_PUBLIC_ALIAS_PREFER_REDIS=1

################################################################################
# Logging
################################################################################

# Enable file logging and directory/name
LOG_ENABLE=0                        # App file logging off by default; use LOG_VERBOSE=1 in dev
LOG_DIR=./logs
LOG_FILE_BASENAME=app

# Console log level (debug|info|warn|error)
LOG_LEVEL=debug

# Monitor-only modes
LOG_MONITOR_ONLY=0
LOG_MONITOR_START_ONLY=0
# Single switch for verbose logging across app log, aliases-XML reads, and monitor logs
# 1 = enable verbose logs (dev); 0 = disable (prod)
LOG_VERBOSE=0

# Optional per-tag minimum levels (comma-separated list)
# Example: redis=warn,ksk-lock=warn
# LOG_TAG_LEVELS=
LOG_TAG_LEVELS=scanner=debug,scan:sink=info,scan:mem=info,api:serial/scanner=info,api:serial/events=info

# Verbose scan diagnostics (client and server hints)
SCAN_LOG=1
NEXT_PUBLIC_SCAN_LOG=1
SCAN_MEM_LOG=1
LOG_SCANNER_POLL_VERBOSE=1

# UI overlays and polling
NEXT_PUBLIC_OK_OVERLAY_MS=1200
NEXT_PUBLIC_SCAN_OVERLAY_MS=3000
NEXT_PUBLIC_REDIS_DROP_DEBOUNCE_MS=900
NEXT_PUBLIC_SCANNER_POLL_IF_STALE_MS=4000

################################################################################
# Misc / Legacy
################################################################################

# Force checkpoint status for testing (ok|true|1). Leave empty in normal use.
KROSY_FORCE_CHECKPOINT_RESULT=

# Legacy (kept for reference)
KROSY_XML_TARGET=ksskkfb01          # DO NOT CHANGE
KROSY_OFFLINE_PORT=3001             # DO NOT CHANGE
KROSY_OFFLINE_PATH=/api/visualcontrol  # DO NOT CHANGE
KROSY_OGLIEN_URL=http://localhost:3001/api/visualcontrol  # DO NOT CHANGE

################################################################################
# Electron (desktop packaging)
################################################################################

## Devtools and remote probing
# Open devtools in dev
WFKB_DEVTOOLS=1
# Force remote server base (rare) e.g. http://172.26.202.248:3000
WFKB_BASE_URL=
# When 1, always use remote base and do not start local server
WFKB_FORCE_REMOTE=0
# When 1, skip remote availability probe (saves ~3s if offline)
WFKB_DISABLE_REMOTE_PROBE=0

## Renderer/Chromium tuning (Jetson friendly – enable on device)
# Prefer EGL on Linux/ARM
WFKB_USE_EGL=1
# Ignore Chromium GPU blocklist
WFKB_IGNORE_GPU_BLOCKLIST=1
# Accelerate canvas and enable GPU rasterization
WFKB_ENABLE_CANVAS_ACCEL=1
# Use zero-copy and native GPU memory buffers
WFKB_ENABLE_ZERO_COPY=1
# Avoid background throttling (keeps timers responsive)
WFKB_DISABLE_BG_THROTTLING=1
# Apply low-end device mode; optionally set raster threads
WFKB_LOW_END_MODE=1
# WFKB_RASTER_THREADS=2
# Disable proxy auto-detect (avoids startup delay)
WFKB_NO_PROXY=1
# Optional Vulkan (enable only if drivers support it)
WFKB_USE_VULKAN=0
# Optional ozone platform hint (x11|wayland)
WFKB_OZONE_PLATFORM=x11
# Fallback: disable GPU entirely if you see black screens or crashes
WFKB_DISABLE_GPU=0
# Kiosk mode in production (fullscreen)
WFKB_KIOSK=1
# Optional remote base URL (forces remote when WFKB_FORCE_REMOTE=1)
WFKB_BASE_URL=
WFKB_FORCE_REMOTE=0
WFKB_DISABLE_AUTO_ZOOM=1
WFKB_DISABLE_WHEEL_ZOOM=1
NEXT_PUBLIC_KSK_SLOTS=4
